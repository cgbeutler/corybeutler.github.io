<title>Cory Beutler</title>
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/prism.css" />

<body>
    <div id="main-title">Cory Beutler: The Blog</div>
            
    <div id="nav-menu">
      <a href="/index.html">
        <div class="block-button">
          Home
        </div>
      </a>
      <a href="/blog.html">
        <div class="block-button">
          Blog
        </div>
      </a>
    </div>

    <div id="content">
        <div>
            
            <div id="breadcrumb"> <a href="/index.html">Home</a> > <a href="/blog.html">Blog</a> > 2020-5-29 </div>
            
            <h1>ExportAs CSharp Attribute for Godot</h1>
            <p>
                In Godot, it is possible to export properties in sub-sections like so:
            </p>
            
            <img style="margin: auto; display: block" src="./properties.png">
            
            <p>
                To do this, a property must be exported named something like "pixel_snapping/enabled". This can be done by returning a list of dictionaries from an overloaded <code>_GetPropertyList()</code> function.
            </p>
            <p>
                If you overload <code>_GetPropertyList()</code>, you also have to overload <code>_Get(...)</code> and <code>_Set(...)</code>, which quickly becomes a lot of boilerplate to manage just for sub-sections.
            </p>
            <p>
                To make this process more simple, I wrote a simple CSharp Attribute. It can be used like so:
            </p>
            <pre><code class="language-csharp">
    [ExportAs("pixel_snapping/enabled", Variant.Type.Bool)]
    public bool SnapEnabled {
      get => _snapEnabled;
      set {
        _snapEnabled = value;
        _updatePadding();  QueueSort();
      }
    }
    private bool _snapEnabled = true;
            </code></pre>
            <p>
                This attribute can then be automatically scanned and handled in the <code>_GetPropertyList()</code>,  <code>_Get(...)</code>, and <code>_Set(...)</code> functions with the following calls:
            </p>
            <pre><code class="language-csharp">
    // NOTE: you will want to wrap code in a try-catch right now.
    //       [Tool] mode will crash on exceptions otherwise.
    public override Godot.Collections.Array _GetPropertyList() {
      try {
        return new Godot.Collections.Array( this.GetPropertyListFromAttributes() );
      } catch ( Exception e ) {
        System.Console.WriteLine( $"[{nameof(MyClass)}] _GetPropertyList Exception: {e}\n{e.StackTrace}" );
        throw;
      }
    }

    public override bool _Set(string propertyStr, object value) {
      try {
        return this.TryToSetPropertyWithAttribute( propertyStr, value );
      } catch ( Exception e ) {
        Console.WriteLine( $"[{nameof(MyClass)}] _Set Exception: {e}\n{e.StackTrace}" );
        return false;
      }
    }

    public override object? _Get(string propertyStr) {
      try {
        return this.TryToGetPropertyWithAttribute( propertyStr );
      } catch ( Exception e ) {
        Console.WriteLine( $"[{nameof(MyClass)}] _Get Exception: {e}\n{e.StackTrace}" );
        return null;
      }
    }
            </code></pre>
            
            <p>
                To use this Attribute, simply add this Gist class to your project:<br>
                <a href="https://gist.github.com/cgbeutler/8c85657bcaaa130aef45d14a677c981f">ExportAsAttribute.cs</a>
            </p>
            
            <script src="https://gist.github.com/cgbeutler/8c85657bcaaa130aef45d14a677c981f.js"></script>
            
            <p>
                Hope it helps!
            </p>
            
        </div>
    </div>
    
    <div id="external-links">
        <span style="margin: 0pt 10pt"> You can also find me on:</span>
        <a href="https://aristonaut.itch.io/">
          <img src="/img/itchio_logo.svg" style="height: 14pt">
        </a>
        <a href="https://m.soundcloud.com/aristonaut">
          <img src="/img/soundcloud_logo.png" style="height: 14pt">
        </a>
        <a href="https://github.com/cgbeutler">
          <img src="/img/github_logo.png" style="height: 14pt">
        </a>
    </div>
    
    <script src="/prism.js"></script>
</body>
